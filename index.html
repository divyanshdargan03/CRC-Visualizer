<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRC Visualizer</title>
    <base href="/CRC-Visualizer/">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/additional.css">
    <link rel="stylesheet" href="css/scroll.css">
</head>
<body>
    <div class="container">
        <div id="topSection">
            <div class="top-row">
                <h1>CRC Visualizer</h1>
                <div class="header-controls">
                    <div class="theme-toggle">
                        <input type="checkbox" id="themeToggle" aria-label="Toggle dark mode">
                        <label for="themeToggle" class="toggle-label" title="Toggle dark mode">
                            <span class="toggle-knob">
                                <!-- Sun icon (circle + rays group for rotation) -->
                                <svg class="icon sun" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
                                    <g class="sun-rays" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round">
                                        <path d="M12 2.5v2.5" />
                                        <path d="M12 19v2.5" />
                                        <path d="M4.5 5.5l1.8 1.8" />
                                        <path d="M17.7 16.7l1.8 1.8" />
                                        <path d="M2.5 12h2.5" />
                                        <path d="M19 12h2.5" />
                                        <path d="M4.5 18.5l1.8-1.8" />
                                        <path d="M17.7 7.3l1.8-1.8" />
                                    </g>
                                    <circle cx="12" cy="12" r="4" fill="currentColor" />
                                </svg>
                                <!-- Moon icon (crescent) -->
                                <svg class="icon moon" viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
                                    <path fill="currentColor" d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
                                </svg>
                            </span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="project-meta">
                <div><strong>Project:</strong> CRC Visualizer — Computer Networks</div>
                <div><strong>Student:</strong> Divyansh Dargan (Reg: 24BCE5131)</div>
                <div>
                <strong>Student:</strong> Aviskha Talukdar<br>
                (Reg: 24BCE5100)
                </div><div>
                <strong>Student:</strong> Mokshdaa Gupta<br>
                (Reg: 24BCE5095)
                </div>
                
                <div><strong>Professor:</strong> Dr. Swaminathan A</div>
            </div>
        
        <!-- Tab navigation -->
        <nav class="tabs" role="tablist" aria-label="Main navigation tabs">
            <button class="tab-button active" role="tab" aria-selected="true" aria-controls="crc-generator-panel" id="tab-crc">CRC Generator</button>
            <button class="tab-button" role="tab" aria-selected="false" aria-controls="algorithm-panel" id="tab-algo">Algorithm</button>
            <button class="tab-button" role="tab" aria-selected="false" aria-controls="working-panel" id="tab-working">Working Principle</button>
        </nav>

        <!-- Tab panels -->
        <section class="tab-panel" id="crc-generator-panel" role="tabpanel" aria-labelledby="tab-crc">
        <div class="input-section">
            <div class="form-group">
                <label for="inputFormat">Input Format:</label>
                <select id="inputFormat">
                    <option value="binary">Binary</option>
                    <option value="decimal">Decimal</option>
                    <option value="hex">Hexadecimal</option>
                    <option value="ascii">ASCII</option>
                    <option value="text">Text</option>
                </select>
            </div>

            <div class="form-group">
                <label for="inputData">Input Data:</label>
                <input type="text" id="inputData" placeholder="Enter your data">
            </div>

            <div class="form-group">
                <label for="polynomialType">Generator Polynomial:</label>
                <select id="polynomialType">
                    <option value="custom">Custom</option>
                    <option value="crc8">CRC-8 (x⁸ + x² + x + 1)</option>
                    <option value="crc16">CRC-16 (x¹⁶ + x¹⁵ + x² + 1)</option>
                    <option value="crc32">CRC-32 (x³² + x²⁶ + x²³ + x²² + x¹⁶ + x¹² + x¹¹ + x¹⁰ + x⁸ + x⁷ + x⁵ + x⁴ + x² + x + 1)</option>
                </select>
            </div>

            <div id="customPolyDiv" class="form-group">
                <label for="customPoly">Custom Polynomial (binary):</label>
                <input type="text" id="customPoly" placeholder="e.g., 1011 for x³ + x + 1">
            </div>

            <div class="form-group">
                <label for="mode">Mode:</label>
                <select id="mode">
                    <option value="sender">Sender (Encode)</option>
                    <option value="receiver">Receiver (Verify)</option>
                </select>
            </div>

            <button id="calculate" class="primary-btn">Calculate CRC</button>
        </div>

        <div class="visualization-section">
            <h2>Binary Conversion</h2>
            <div id="binaryConversion" class="result-box"></div>

            <h2>CRC Calculation Steps</h2>
            <div id="crcSteps" class="result-box"></div>

            <h2>Final Result</h2>
            <div id="finalResult" class="result-box"></div>
        </div>

        <div class="error-simulation-section">
            <h2>Error Simulation</h2>
            <div class="form-group">
                <label for="errorType">Error Type:</label>
                <select id="errorType">
                    <option value="single">Single-bit Error</option>
                    <option value="double">Double-bit Error</option>
                    <option value="burst">Burst Error</option>
                </select>
            </div>
            <div class="form-group">
                <label for="bitPosition">Bit Position(s):</label>
                <input type="text" id="bitPosition" placeholder="e.g., 3 or 1,4 for multiple positions">
            </div>
            <button id="simulateError" class="secondary-btn">Simulate Error</button>
            <div id="errorResult" class="result-box"></div>
        </div>

        <div id="polynomialVisual" class="polynomial-section">
            <h2>Polynomial Visualization</h2>
            <div class="result-box">
                <div id="polyMath"></div>
                <div id="polyBinary"></div>
            </div>
        </div>
        </section>

        <section class="tab-panel smooth-toggle smooth-hidden" id="algorithm-panel" role="tabpanel" aria-labelledby="tab-algo">
            <div class="result-box">
                <h2>Algorithm</h2>
                <article class="markdown">
                    <h3>Problem setup</h3>
                    <ul>
                        <li>Message bits: <code>M</code> (any format is first converted to binary).</li>
                        <li>Generator polynomial (binary): <code>G</code>, length <code>m</code> and degree <code>m − 1</code>.</li>
                        <li>Division is in GF(2): addition/subtraction is XOR; no carries.</li>
                    </ul>

                    <h3>Encoding (Sender)</h3>
                    <ol>
                        <li>Convert input to binary: <code>M</code>.</li>
                        <li>Pad with <code>m − 1</code> zeros: <code>P = M · 2<sup>m−1</sup></code> (append <code>m−1</code> zeros).</li>
                        <li>Perform long division of <code>P</code> by <code>G</code> bit-by-bit:
                            <ul>
                                <li>Slide a window of size <code>m</code> from left to right.</li>
                                <li>If the window’s left bit is <code>1</code>, XOR the window with <code>G</code> and write back.</li>
                                <li>If it is <code>0</code>, just advance the window (no XOR).</li>
                            </ul>
                        </li>
                        <li>The final <code>m − 1</code> bits are the remainder <code>R</code> (the CRC).</li>
                        <li>Encoded message: <code>M || R</code>.</li>
                    </ol>

                    <details>
                        <summary>Pseudocode (bitwise division)</summary>
<pre><code>input: M (binary string), G (binary string), m = len(G)
# pad
P = M + "0" * (m-1)
W = list(P)  # mutable working array
for i in range(0, len(P) - m + 1):
    if W[i] == '1':
        for j in range(0, m):
            W[i+j] = '0' if (W[i+j] == G[j]) else '1'  # XOR
# remainder is last m-1 bits
R = ''.join(W[len(P)-(m-1):])
encoded = M + R
</code></pre>
                    </details>

                    <h3>Verification (Receiver)</h3>
                    <ol>
                        <li>Receive <code>M' = M || R</code> and choose <code>G</code> (defaults to the sender’s choice here).</li>
                        <li>Run the same division on <code>M'</code> by <code>G</code>.</li>
                        <li>If the final remainder is all zeros, the frame is considered valid; otherwise an error is detected.</li>
                    </ol>

                    <h3>Notes and edge cases</h3>
                    <ul>
                        <li><strong>All-zero message</strong>: still yields a deterministic CRC based on <code>G</code>.</li>
                        <li><strong>Leading zeros</strong> in <code>M</code> are preserved; division is positional.</li>
                        <li><strong>Custom polynomials</strong> should be binary and start with <code>1</code> to define degree <code>m−1</code>.</li>
                        <li>Time complexity is <code>O(n · m)</code>, for message length <code>n</code> and polynomial length <code>m</code>.</li>
                    </ul>
                </article>
            </div>
        </section>

        <section class="tab-panel smooth-toggle smooth-hidden" id="working-panel" role="tabpanel" aria-labelledby="tab-working">
            <div class="result-box">
                <h2>Working Principle</h2>
                <article class="markdown">
                    <h3>CRC as polynomial arithmetic over GF(2)</h3>
                    <p>
                        A binary string (e.g., <code>11001</code>) is viewed as a polynomial with coefficients in GF(2),
                        e.g., <code>1·x⁴ + 1·x³ + 0·x² + 0·x + 1</code>. The generator <code>G</code> is also a polynomial
                        whose highest coefficient is <code>1</code> (so its degree is well-defined).
                    </p>
                    <p>
                        Division is standard long division but with XOR as add/subtract. There are no carries in GF(2).
                        Each time the current window’s leading bit is <code>1</code>, we XOR the window with the generator.
                        When it’s <code>0</code>, we just advance to the next position. Our visualizer shows this as
                        “window → generator → underline → XOR result”, aligned under the dividend.
                    </p>

                    <h3>Why append zeros before division?</h3>
                    <p>
                        Appending <code>m−1</code> zeros is equivalent to multiplying the message polynomial by <code>x<sup>m−1</sup></code>,
                        reserving space for the remainder produced by the division. The remainder bits overwrite these zeros and
                        become the CRC appended at the sender.
                    </p>

                    <h3>Sender/Receiver symmetry</h3>
                    <ul>
                        <li><strong>Sender</strong>: computes remainder <code>R</code> from <code>M·x<sup>m−1</sup></code> ÷ <code>G</code>, transmits <code>M || R</code>.</li>
                        <li><strong>Receiver</strong>: divides <code>M || R</code> by the same <code>G</code>. If the remainder is all zeros, the frame passes; otherwise it’s flagged.</li>
                    </ul>

                    <h3>Error detection intuition</h3>
                    <p>
                        If noise flips some bits producing error polynomial <code>E(x)</code>, the received polynomial becomes
                        <code>M(x)·x<sup>m−1</sup> + R(x) + E(x)</code>. By construction, <code>M(x)·x<sup>m−1</sup> + R(x)</code> is divisible by <code>G(x)</code>,
                        so the receiver’s remainder equals <code>E(x) mod G(x)</code>. Well-chosen standard polynomials detect many common error patterns
                        (all single-bit errors, most short burst errors, and more).
                    </p>

                    <h3>Limitations</h3>
                    <ul>
                        <li>CRC provides integrity, not authenticity; it is not a cryptographic MAC.</li>
                        <li>Some rare error patterns are undetected depending on <code>G</code>; standards choose <code>G</code> to minimize these.</li>
                    </ul>
                </article>
            </div>
        </section>
    </div>
    <script>
        // Simple tab switching logic
        (function() {
            function $(sel, ctx) { return (ctx || document).querySelector(sel); }
            function $all(sel, ctx) { return Array.from((ctx || document).querySelectorAll(sel)); }

            const tabButtons = $all('.tab-button');
            const tabPanels = $all('.tab-panel');

            function activateTab(button) {
                const targetId = button.getAttribute('aria-controls');

                // deactivate all buttons
                tabButtons.forEach(b => {
                    b.classList.remove('active');
                    b.setAttribute('aria-selected', 'false');
                });

                // hide all panels
                tabPanels.forEach(p => {
                    p.classList.add('smooth-hidden');
                    p.classList.remove('smooth-shown');
                    p.setAttribute('hidden', '');
                });

                // activate clicked button
                button.classList.add('active');
                button.setAttribute('aria-selected', 'true');

                // show target panel
                const panel = document.getElementById(targetId);
                if (panel) {
                    panel.classList.remove('smooth-hidden');
                    panel.classList.add('smooth-shown');
                    panel.removeAttribute('hidden');
                }
            }

            tabButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    activateTab(btn);
                    // scroll to top of container when switching tabs on small screens
                    const container = document.querySelector('.container');
                    if (container) container.scrollIntoView({behavior: 'smooth'});
                });
            });

            // Initialize: ensure only the active panel is visible
            const initial = document.querySelector('.tab-button.active') || tabButtons[0];
            if (initial) activateTab(initial);
        })();
    </script>
    <script src="js/crc.js"></script>
</body>
</html>